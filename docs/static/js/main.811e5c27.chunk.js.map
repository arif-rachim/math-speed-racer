{"version":3,"sources":["comp/Session.js","comp/App.js","index.js","comp/App.module.css","comp/Session.module.css"],"names":["Session","onEnd","useContext","AppContext","appContext","setAppContext","useState","initiateState","session","setSession","answers","length","activeRowIndex","setActiveRowIndex","activeColumnIndex","setActiveColumnIndex","delayBetweenQuestionsInMilliseconds","config","containerWidth","setContainerWidth","questions","totalQuestions","useEffect","startNewQuestion","columnsEachRow","delayBetweenColumnsInMilliseconds","playbackRate","isEnd","end","isWaitingForAnswer","numberValue","getValue","onSessionUpdated","waitingForAnswerRef","useRef","onWaitingForAnswer","containerRef","current","offsetWidth","onMounted","onSessionEnd","progress","Math","round","ref","className","styles","container","style","width","position","top","background","height","transition","map","q","rowIndex","n","colIndex","data-audio","src","type","fontSize","Answer","onAnswer","answer","durations","Date","getTime","toISOString","buildQuestions","totalSums","questionsEachSum","digits","negativePercentage","sums","number","parseInt","Array","from","_","index","ceil","random","floor","join","hasSimilarItemInQuestions","indexOf","ifTotalIsLesserThanZero","reduce","total","next","push","audio","document","querySelector","addEventListener","setTimeout","play","columnIndex","err","start","oldAppContext","oldSession","sessions","filter","s","unfinishedSessions","handleSubmit","event","preventDefault","target","elements","value","onSubmit","answerBox","name","autoFocus","SPEED_RACER_CONFIG","SPEED_RACER_SESSIONS","DEFAULT_CONFIG","onStartSession","setStartSession","React","createContext","App","JSON","parse","localStorage","getItem","stringify","setAppContextPersist","useCallback","functionToCheck","newContext","toString","call","setItem","createAppContextPersist","startSession","Provider","useMemo","HomePage","calculateScore","totalCorrect","t","month","undefined","homePage","button","onClick","date","indexOfCurrentSessionSelection","hasNext","hasPrevious","buttonContainer","buttonPrevNext","disabled","flex","title","score","getDate","getMonth","getFullYear","getHours","getMinutes","tableContainer","table","tdAnswer","textCenter","tot","ReactDOM","render","getElementById","module","exports"],"mappings":"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","file":"static/js/main.811e5c27.chunk.js","sourcesContent":["import {useContext, useEffect, useRef, useState} from \"react\";\r\nimport {AppContext} from \"./App\";\r\nimport styles from \"./Session.module.css\";\r\n\r\n\r\nconst onMounted = (containerRef, setContainerWidth) => () => {\r\n    return setContainerWidth(containerRef.current.offsetWidth);\r\n}\r\n\r\nconst onSessionEnd = (isEnd, onEnd) => () => {\r\n    if (isEnd) {\r\n        onEnd();\r\n    }\r\n}\r\n\r\nexport default function Session({onEnd}) {\r\n    const [appContext, setAppContext] = useContext(AppContext);\r\n    const [session, setSession] = useState(initiateState(appContext));\r\n\r\n    const [activeRowIndex, setActiveRowIndex] = useState(session.answers.length);\r\n    const [activeColumnIndex, setActiveColumnIndex] = useState(0);\r\n    const {delayBetweenQuestionsInMilliseconds} = appContext.config;\r\n    const [containerWidth, setContainerWidth] = useState(800);\r\n    let {questions} = session;\r\n    questions = questions || [];\r\n    const totalQuestions = questions && questions[activeRowIndex] && questions[activeRowIndex].length || 0;\r\n    useEffect(() => setActiveColumnIndex(0), [activeRowIndex])\r\n    useEffect(startNewQuestion({\r\n        activeColumnIndex,\r\n        setActiveColumnIndex,\r\n        columnsEachRow: totalQuestions,\r\n        delayBetweenColumnsInMilliseconds: delayBetweenQuestionsInMilliseconds,\r\n        activeRowIndex,\r\n        playbackRate: appContext.config.playbackRate\r\n    }), [activeColumnIndex, totalQuestions]);\r\n    const isEnd = session.end.length > 0;\r\n    const isWaitingForAnswer = activeColumnIndex === totalQuestions && !isEnd;\r\n    const numberValue = getValue(questions, activeRowIndex, activeColumnIndex);\r\n    useEffect(onSessionUpdated(setAppContext, session), [session]);\r\n    const waitingForAnswerRef = useRef(null);\r\n    useEffect(onWaitingForAnswer(waitingForAnswerRef, isWaitingForAnswer), [isWaitingForAnswer]);\r\n    const containerRef = useRef();\r\n    useEffect(onMounted(containerRef, setContainerWidth), []);\r\n    useEffect(onSessionEnd(isEnd, onEnd), [isEnd]);\r\n\r\n    const progress = Math.round(((activeRowIndex + 1) / questions.length) * 100);\r\n    return <div ref={containerRef} className={styles.container}>\r\n        <div style={{width: '100%', position: 'absolute', top: 0, background: 'rgba(0,0,0,0.1)'}}>\r\n            <div style={{width: `${progress}%`, background: 'green', height: 10,transition:'width 1000ms ease-in-out'}}/>\r\n        </div>\r\n        {questions.map((q, rowIndex) => {\r\n            return <div key={rowIndex}>{q.map((n, colIndex) => {\r\n                return <audio key={`${rowIndex}-${colIndex}`} data-audio={`${rowIndex}-${colIndex}`}>\r\n                    <source src={`audio/${n}.wav`} type=\"audio/wav\"/>\r\n                    Your browser does not support the audio element.\r\n                </audio>\r\n            })}</div>\r\n        })}\r\n        <div style={{fontSize: containerWidth * 0.45}}>{numberValue}</div>\r\n        {isWaitingForAnswer && <Answer containerWidth={containerWidth} onAnswer={(answer) => {\r\n            if (answer) {\r\n                setSession(session => {\r\n                    const answers = session['answers'] || [];\r\n                    const durations = session['durations'] || [];\r\n                    answers[activeRowIndex] = answer;\r\n                    durations[activeRowIndex] = new Date().getTime() - waitingForAnswerRef.current.getTime();\r\n                    const isEnd = answers.length === session.questions.length;\r\n                    return {...session, answers, durations, end: isEnd ? new Date().toISOString() : ''};\r\n                })\r\n                setActiveRowIndex(activeRowIndex + 1);\r\n            }\r\n        }}/>}\r\n    </div>\r\n}\r\n\r\nfunction buildQuestions({totalSums, questionsEachSum, digits, negativePercentage}) {\r\n    let sums = [];\r\n    while (sums.length < totalSums) {\r\n        let questions = [];\r\n        while (questions.length < questionsEachSum) {\r\n            let number = parseInt((Array.from({length: digits}).map((_, index) => {\r\n                if (index === 0) {\r\n                    return Math.ceil(Math.random() * 9)\r\n                } else {\r\n                    return Math.floor(Math.random() * 10)\r\n                }\r\n            }).join('')));\r\n\r\n            const isNegative = Math.ceil(Math.random() * 10) <= (10 * negativePercentage);\r\n            number = isNegative ? -1 * number : number;\r\n            const hasSimilarItemInQuestions = questions.indexOf(number) >= 0;\r\n            const ifTotalIsLesserThanZero = questions.reduce((total, next) => total + next, number) <= 0;\r\n            if (!hasSimilarItemInQuestions && !ifTotalIsLesserThanZero) {\r\n                questions.push(number);\r\n            }\r\n        }\r\n        sums.push(questions);\r\n    }\r\n    return sums;\r\n}\r\n\r\n\r\nconst startNewQuestion = ({\r\n                              activeColumnIndex,\r\n                              setActiveColumnIndex,\r\n                              columnsEachRow,\r\n                              delayBetweenColumnsInMilliseconds, activeRowIndex, playbackRate\r\n                          }) => () => {\r\n    const audio = document.querySelector(`[data-audio=\"${activeRowIndex}-${activeColumnIndex}\"]`);\r\n\r\n    if (audio) {\r\n        audio.addEventListener('ended', () => {\r\n            setTimeout(() => {\r\n                if (activeColumnIndex < columnsEachRow) {\r\n                    setActiveColumnIndex(activeColumnIndex + 1);\r\n                }\r\n            }, delayBetweenColumnsInMilliseconds);\r\n        })\r\n        audio.playbackRate = playbackRate;\r\n        audio.play();\r\n    } else {\r\n        if (activeColumnIndex < columnsEachRow) {\r\n            setActiveColumnIndex(activeColumnIndex + 1);\r\n        }\r\n    }\r\n}\r\n\r\n\r\nconst getValue = (questions, rowIndex, columnIndex) => {\r\n    try {\r\n        return questions[rowIndex][columnIndex]\r\n    } catch (err) {\r\n    }\r\n    return 0;\r\n}\r\n\r\nconst onSessionUpdated = (setAppContext, session) => () => {\r\n    if (session.start) {\r\n        setAppContext(oldAppContext => {\r\n            const oldSession = oldAppContext.sessions.filter(s => s.start !== session.start);\r\n            return {...oldAppContext, sessions: [...oldSession, session]};\r\n        });\r\n\r\n    }\r\n}\r\n\r\nconst onWaitingForAnswer = (waitingForAnswerRef, isWaitingForAnswer) => () => {\r\n    if (isWaitingForAnswer) {\r\n        waitingForAnswerRef.current = new Date();\r\n    }\r\n}\r\n\r\n\r\nconst initiateState = (appContext) => () => {\r\n    const {config, sessions} = appContext;\r\n    // ok now we have the config lets open last session\r\n    const unfinishedSessions = sessions.filter(s => 'end' in s && s.end.length === 0);\r\n    if (unfinishedSessions && unfinishedSessions.length > 0) {\r\n        return unfinishedSessions[0];\r\n    } else {\r\n        return {\r\n            start: new Date().toISOString(),\r\n            questions: buildQuestions(config),\r\n            answers: [],\r\n            durations: [],\r\n            end: ''\r\n        };\r\n    }\r\n\r\n}\r\n\r\n\r\nconst handleSubmit = (onAnswer) => (event) => {\r\n    event.preventDefault();\r\n    const answer = event.target.elements.answer.value;\r\n    onAnswer(parseInt(answer));\r\n}\r\n\r\nfunction Answer({onAnswer, containerWidth}) {\r\n    return <form onSubmit={handleSubmit(onAnswer)}>\r\n        <input style={{fontSize: containerWidth * 0.3}} className={styles.answerBox} name={\"answer\"} autoFocus={true}/>\r\n    </form>\r\n}","import React, {useCallback, useMemo, useState} from \"react\";\r\nimport Session from \"./Session\";\r\nimport styles from \"./App.module.css\";\r\n\r\nconst SPEED_RACER_CONFIG = 'speed-racer-config';\r\nconst SPEED_RACER_SESSIONS = 'speed-racer-sessions';\r\n\r\nconst DEFAULT_CONFIG = {\r\n    totalSums: 30,\r\n    questionsEachSum: 4,\r\n    digits: 3,\r\n    negativePercentage: 0,\r\n    delayBetweenQuestionsInMilliseconds: 500,\r\n    playbackRate : 1.1\r\n}\r\n\r\nconst onStartSession = (setStartSession) => () => {\r\n    setStartSession(true);\r\n}\r\n\r\nexport const AppContext = React.createContext({});\r\n\r\nfunction isFunction(functionToCheck) {\r\n    return functionToCheck && {}.toString.call(functionToCheck) === '[object Function]';\r\n}\r\n\r\nfunction createAppContextPersist(oldAppContext, setAppContext) {\r\n    return (appContext) => {\r\n        let newContext = appContext;\r\n        if (isFunction(appContext)) {\r\n            newContext = appContext(oldAppContext);\r\n        }\r\n        setAppContext(newContext);\r\n        localStorage.setItem(SPEED_RACER_CONFIG,JSON.stringify(newContext.config));\r\n        localStorage.setItem(SPEED_RACER_SESSIONS,JSON.stringify(newContext.sessions));\r\n    }\r\n}\r\n\r\nexport default function App() {\r\n\r\n    const [appContext, setAppContext] = useState(() => {\r\n        const config = JSON.parse(localStorage.getItem(SPEED_RACER_CONFIG) || JSON.stringify(DEFAULT_CONFIG))\r\n        const sessions = JSON.parse(localStorage.getItem(SPEED_RACER_SESSIONS) || JSON.stringify([]))\r\n        return {config,sessions}\r\n    });\r\n    const setAppContextPersist = useCallback(createAppContextPersist(appContext, setAppContext), [appContext]);\r\n    const [startSession, setStartSession] = useState(false);\r\n    return <AppContext.Provider value={useMemo(() => [appContext, setAppContextPersist], [appContext])}>\r\n        <div className={styles.container}>\r\n            {startSession && <Session onEnd={() => setStartSession(false)} />}\r\n            {!startSession && <HomePage setStartSession={setStartSession} appContext={appContext}/>}\r\n        </div>\r\n    </AppContext.Provider>\r\n}\r\n\r\nconst calculateScore = (session) => {\r\n    if(!session || !session.questions){\r\n        return 0;\r\n    }\r\n    let index = 0;\r\n    let totalCorrect = 0;\r\n    for (const question of session.questions) {\r\n        const expectedAnswer = question.reduce((t,n) => t+parseInt(n),0);\r\n        const answer = session.answers[index];\r\n        if(expectedAnswer === answer){\r\n            totalCorrect++;\r\n        }\r\n        index++;\r\n    }\r\n    return Math.round((totalCorrect / session.questions.length) * 100)\r\n}\r\n\r\nconst month = ['JAN','FEB','MAR','APR','MAY','JUN','JUL','AUG','SEP','OCT','NOV','DEC'];\r\n\r\nconst formatDate = (date) => {\r\n    return `${date.getDate()}-${month[date.getMonth()]}-${date.getFullYear()} ${date.getHours()}:${date.getMinutes()}`\r\n}\r\nfunction HomePage({setStartSession,appContext}){\r\n    const [session,setSession] = useState(appContext?.sessions[appContext.sessions.length - 1]);\r\n    if(session === null || session === undefined){\r\n        return <div className={styles.homePage}><button className={styles.button} onClick={onStartSession(setStartSession)}>Start Session</button></div>\r\n    }\r\n    const indexOfCurrentSessionSelection = appContext.sessions.indexOf(session);\r\n    const hasNext =  indexOfCurrentSessionSelection < appContext.sessions.length - 1;\r\n    const hasPrevious = indexOfCurrentSessionSelection > 0\r\n\r\n    return <div className={styles.homePage}>\r\n\r\n        <div className={styles.buttonContainer}>\r\n            <button className={styles.buttonPrevNext} disabled={!hasPrevious} onClick={() => setSession(appContext.sessions[indexOfCurrentSessionSelection-1])}>Prev Score</button>\r\n            <div style={{flex:1}}/>\r\n            <button className={styles.buttonPrevNext} disabled={!hasNext} onClick={() => setSession(appContext.sessions[indexOfCurrentSessionSelection+1])}>Next Score</button>\r\n        </div>\r\n        <div className={styles.title}>\r\n            <div className={styles.score}>{calculateScore(session)} %</div>\r\n            <div className={styles.date}>{formatDate(new Date(session.start))}</div>\r\n        </div>\r\n        <div className={styles.tableContainer}>\r\n        <table className={styles.table}>\r\n            <thead>\r\n            <tr>\r\n                <th>No</th>\r\n                <th>Questions</th>\r\n                <th>Answers</th>\r\n                <th>Duration</th>\r\n            </tr>\r\n            </thead>\r\n            <tbody>\r\n            {session?.questions?.map((q,index) => {\r\n                return <tr key={index}>\r\n                    <td>{index+1}</td>\r\n                    <td>{q.join(',')}</td>\r\n                    <td className={styles.tdAnswer}>\r\n                        <div className={styles.textCenter} >{session.answers[index]}</div>\r\n                        /\r\n                        <div className={styles.textCenter}>{session.answers[index]?q.reduce((tot,next) => tot + parseInt(next),0):''}</div>\r\n                    </td>\r\n                    <td>{session.durations[index]}</td>\r\n                </tr>\r\n            })}\r\n            </tbody>\r\n        </table>\r\n        </div>\r\n        <button className={styles.button} onClick={onStartSession(setStartSession)}>Start Session</button>\r\n    </div>\r\n}","import ReactDOM from \"react-dom\";\r\nimport App from \"./comp/App\";\r\n\r\nReactDOM.render(<App/>,document.getElementById('root'));\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"App_container__UuO5q\",\"score\":\"App_score__3TOys\",\"button\":\"App_button__24jd2\",\"buttonContainer\":\"App_buttonContainer__26OuR\",\"buttonPrevNext\":\"App_buttonPrevNext__8N1I7\",\"table\":\"App_table__Gqo9z\",\"tdAnswer\":\"App_tdAnswer__13p1L\",\"textCenter\":\"App_textCenter__1_IiW\",\"homePage\":\"App_homePage__26Xma\",\"title\":\"App_title__oaCjv\",\"date\":\"App_date__3qQWM\",\"tableContainer\":\"App_tableContainer__7Pf-r\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"Session_container__1iK6Q\",\"answerBox\":\"Session_answerBox__XlIO6\"};"],"sourceRoot":""}